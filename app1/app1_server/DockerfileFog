FROM arm32v7/ubuntu:18.04

# install necessary ubuntu packages
RUN apt update -y && apt upgrade -y

# change pwd
COPY . /app
#RUN rm -rf yolov3_tiny
WORKDIR /app

# install opencv
RUN chmod +x DockerfileFog.sh
RUN ./DockerfileFog.sh

# download yolov3 weights
# RUN wget https://pjreddie.com/media/files/yolov3.weights

# install pip
RUN pip3 install --upgrade pip
RUN pip3 install -r requirements.txt

# set environment variable for yolov3
ENV YOLO_COCO_NAMES=yolov3/coco.names
ENV YOLO_CONFIG=yolov3/yolov3.cfg
ENV YOLO_WEIGHTS=yolov3/yolov3.weights

# run application
ENTRYPOINT [ "python3" ]
CMD [ "app1_server.py" ]
